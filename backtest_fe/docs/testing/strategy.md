# 프론트엔드 테스트 전략

프론트엔드 테스트는 사용자 경험의 품질을 보장하고, 코드 변경에 따른 부작용을 최소화하며, 애플리케이션의 안정성을 유지하는 데 핵심적인 역할을 합니다. 본 프로젝트는 "테스팅 트로피(Testing Trophy)" 모델의 개념을 차용하여, 사용자에게 가장 큰 가치를 제공하는 **통합(컴포넌트) 테스트**에 집중하면서도, 복잡한 로직을 위한 **단위 테스트**와 핵심 사용자 플로우를 검증하는 **E2E 테스트**를 균형 있게 활용합니다.

## 테스트 레벨

### 1. 단위 테스트 (Unit Tests)

-   **도구**: `Vitest`
-   **목표**: 재사용 가능한 함수, 복잡한 비즈니스 로직, 유틸리티 등 UI와 분리된 순수 로직을 테스트합니다.
-   **범위**:
    -   `shared/utils/`: 날짜 포맷팅, 통계 계산 등 순수 함수.
    -   `features/*/services/`: API 응답 데이터를 가공하는 함수.
    -   `features/*/model/reducers.ts`: `useReducer`의 `reducer` 함수. 복잡한 상태 변경 로직이 예상대로 동작하는지 다양한 액션에 따라 검증합니다.
-   **장점**: 실행 속도가 매우 빠르고, 로직의 정확성을 보장하며, 디버깅이 용이합니다.

### 2. 컴포넌트 테스트 (Component Tests)

-   **도구**: `Vitest` + `React Testing Library`
-   **목표**: **테스트 전략의 핵심.** 개별 컴포넌트 또는 여러 컴포넌트의 조합이 사용자 관점에서 올바르게 렌더링되고 상호작용하는지 검증합니다.
-   **철학**:
    -   **구현 세부 정보 대신 사용자 행동을 테스트**: 컴포넌트의 내부 상태나 생명주기를 직접 테스트하는 대신, 사용자가 화면에서 보고 상호작용하는 방식을 테스트합니다. (예: "버튼을 클릭하면, 특정 텍스트가 나타난다.")
    -   **접근성 우선**: `getByRole`, `getByLabelText` 등 사용자와 보조 기술이 UI를 인식하는 방식과 유사한 쿼리를 사용하여 컴포넌트를 찾습니다.
-   **범위**:
    -   `shared/components/`의 재사용 가능한 컴포넌트.
    -   `features/*/components/`의 기능별 컴포넌트.
    -   `pages/`의 페이지 레벨 컴포넌트 (여러 기능을 조합).

### 3. 종단간 테스트 (End-to-End Tests)

-   **도구**: `Playwright`
-   **위치**: `e2e/`
-   **목표**: 실제 브라우저 환경에서 사용자의 핵심 워크플로우가 처음부터 끝까지 올바르게 동작하는지 확인합니다.
-   **범위**:
    -   **백테스트 실행 플로우**: 사용자가 종목을 선택하고, 날짜를 입력하며, "백테스트 실행" 버튼을 눌러 결과 차트와 통계 테이블을 확인하기까지의 전체 과정.
    -   **포트폴리오 리밸런싱 플로우**: 여러 자산을 추가하고, 리밸런싱 주기를 설정하여 포트폴리오 백테스트를 실행하는 과정.
-   **장점**: 프론트엔드와 백엔드를 포함한 전체 시스템의 통합적인 신뢰도를 가장 확실하게 보장합니다.
-   **단점**: 실행 속도가 가장 느리고, 외부 환경(네트워크, 백엔드 서버 상태)에 영향을 받기 쉬워 불안정할 수 있습니다. 따라서 핵심적인 시나리오에 대해서만 최소한으로 작성합니다.

## 테스트 실행 및 커버리지

-   **실행 명령어**: `npm run test` (모든 단위/컴포넌트 테스트 실행), `npm run test:ui` (UI 모드), `npm run test:e2e` (E2E 테스트 실행).
-   **커버리지**: 단순히 코드 라인 커버리지 숫자에 집착하기보다는, 중요한 사용자 시나리오와 복잡한 비즈니스 로직이 충분히 테스트되고 있는지를 질적으로 판단하는 것을 목표로 합니다.
